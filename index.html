<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<title>사건/순찰차 배치 시뮬레이션</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
  #map { height: 100vh; }
  .custom-label {
    background: white;
    padding: 2px 5px;
    border: 1px solid black;
    border-radius: 4px;
    font-size: 12px;
  }
</style>
</head>
<body>
<div id="map"></div>
<script>
// 지도 초기화
const map = L.map('map').setView([37.5665, 126.9780], 13);

// 타일 레이어
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

// 아이콘 설정
const patrolIcon = L.icon({
  iconUrl: "https://cdn-icons-png.flaticon.com/512/296/296216.png", // 🚓 아이콘 (무료 PNG)
  iconSize: [40, 40],
  iconAnchor: [20, 40],
  popupAnchor: [0, -35]
});

const incidentIcon = L.icon({
  iconUrl: "https://cdn-icons-png.flaticon.com/512/463/463574.png", // ❗ 사건 아이콘
  iconSize: [35, 35],
  iconAnchor: [17, 35],
  popupAnchor: [0, -30]
});

// 상태
let mode = "incident"; // 기본 모드: 사건 추가
let incidentMarker = null;
let patrolMarkers = [];

// 지도 클릭 이벤트
map.on("click", function(e) {
  if (mode === "incident") {
    if (incidentMarker) map.removeLayer(incidentMarker);
    incidentMarker = L.marker(e.latlng, {icon: incidentIcon})
      .bindPopup("사건 위치")
      .addTo(map);
  } else if (mode === "patrol") {
    let patrolNum = prompt("순찰차 번호를 입력하세요:", "101");
    if (patrolNum) {
      let marker = L.marker(e.latlng, {icon: patrolIcon})
        .bindPopup("순찰차 " + patrolNum)
        .addTo(map);
      patrolMarkers.push({marker, num: patrolNum});
    }
  }
});

// 키보드 단축키
document.addEventListener("keydown", function(e) {
  if (e.key === "1") {
    mode = "incident";
    alert("사건 위치 모드");
  }
  if (e.key === "2") {
    mode = "patrol";
    alert("순찰차 배치 모드");
  }
});
</script>
</body>
</html>
